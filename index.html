<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>LKZ Matrizes</title>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<style>
body{margin:0;font-family:Inter,Arial;background:#0f172a;color:#fff}
nav{display:flex;gap:15px;padding:15px;background:#111827}
nav a{color:#fff;text-decoration:none;font-weight:700}
.page{display:none;padding:30px}
.active{display:block}
.card{background:#1e293b;padding:20px;border-radius:15px;margin-bottom:20px}
input,textarea,button{width:100%;padding:10px;border-radius:10px;border:none;margin-top:10px}
button{background:#6366f1;color:#fff;font-weight:800;cursor:pointer}
.stat{font-size:22px;font-weight:900}
</style>
</head>
<body>

<nav>
<a href="/Matrizes/Inicio">Inicio</a>
<a href="/Matrizes/Compra">Compra</a>
<a href="/Matrizes/Avaliar">Avaliar</a>
<a href="/Matrizes/Adm">Adm</a>
</nav>

<div id="Inicio" class="page">
<div class="card">
<h1>LKZ MATRIZES</h1>
<p id="satisfacaoTxt"></p>
<p>Média de Avaliações: <span class="stat" id="media"></span></p>
<p>Total de Avaliações: <span class="stat" id="totalAval"></span></p>
<p>Total de Pedidos: <span class="stat" id="pedidos"></span></p>
</div>
</div>

<div id="Compra" class="page">
<div class="card">
<h2>Compra</h2>
<p>Entre em contato para realizar seu pedido</p>
</div>
</div>

<div id="Avaliar" class="page">
<div class="card">
<h2>Avaliar Serviço</h2>
<input type="number" id="nota" min="0" max="5" placeholder="Nota 0 a 5">
<textarea id="comentario" placeholder="Comentário opcional"></textarea>
<button onclick="enviarAvaliacao()">Enviar Avaliação</button>
</div>
</div>

<div id="Adm" class="page">
<div class="card">
<h2>Administração</h2>
<input type="number" id="pedidosAdm" placeholder="Número de pedidos">
<input type="text" id="textoAdm" placeholder="Texto satisfação">
<button onclick="salvarAdm()">Salvar</button>
</div>
</div>

<script>
const firebaseConfig={
databaseURL:"https://dados-e6625-default-rtdb.firebaseio.com/"
}
firebase.initializeApp(firebaseConfig)
const db=firebase.database()

function route(){
let p=location.pathname
if(p.endsWith("/Matrizes/")||p.endsWith("/Matrizes")) location.replace("/Matrizes/Inicio")
document.querySelectorAll(".page").forEach(e=>e.classList.remove("active"))
if(p.includes("Compra")) Compra.classList.add("active")
else if(p.includes("Avaliar")) Avaliar.classList.add("active")
else if(p.includes("Adm")) Adm.classList.add("active")
else Inicio.classList.add("active")
}
route()
window.onpopstate=route

function enviarAvaliacao(){
let n=parseFloat(nota.value)
if(isNaN(n)||n<0||n>5)return
let c=comentario.value||""
let ref=db.ref("avaliacoes").push()
ref.set({nota:n,comentario:c})
location.href="/Matrizes/Inicio"
}

function salvarAdm(){
db.ref("config").set({
pedidos:parseInt(pedidosAdm.value)||0,
texto:textoAdm.value||"Está satisfeito com nosso serviço?"
})
}

db.ref("avaliacoes").on("value",s=>{
let v=s.val()||{}
let notas=Object.values(v).map(a=>a.nota)
let total=notas.length
let media=total? (notas.reduce((a,b)=>a+b,0)/total).toFixed(2):"0"
media.innerText=media
totalAval.innerText=total
})

db.ref("config").on("value",s=>{
let v=s.val()||{}
pedidos.innerText=v.pedidos||0
satisfacaoTxt.innerText=v.texto||"Está satisfeito com nosso serviço?"
})
</script>

</body>
</html>
